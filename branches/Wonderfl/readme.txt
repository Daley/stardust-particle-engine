This branch provides backward compatibility with renderers.
Note that this is a trade-off for performance: the performance is slightly worse.